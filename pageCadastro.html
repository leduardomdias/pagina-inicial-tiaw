<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="icon" href="images/iconeLogo.png" type="image/x-icon" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Poppins", sans-serif;
        display: flex;
        flex-direction: column;
        min-height: 100vh;
        margin: 0;
      }
      main {
        flex: 1;
      }
      footer {
        background-color: #343a40;
        color: #ffffff;
        text-align: center;
        padding: 20px 0;
        margin-top: auto;
      }
      #noText {
        text-decoration: none;
      }
    </style>
    <title>Cadastrar Pet - FindPet</title>
  </head>
  <body>
    <header>
      <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
          <a class="navbar-brand" href="index.html">
            <img
              src="images/logo_findpet.png"
              alt="Logo"
              width="50"
              height="50"
              id="img"
              class="m-2 mx-2"
            />
          </a>

          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarContent"
            aria-controls="navbarContent"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>

          <div class="collapse navbar-collapse" id="navbarContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0 mx-3">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="#">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">Sobre</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">Fórum</a>
              </li>
              <li class="nav-item">
                <a class="nav-link fw-bold text-success" href="pets.html"
                  >Meus Pets</a
                >
              </li>
              <li class="nav-item d-flex align-items-center ms-4">
                <a href="perfilDoUsuario.html" id="noText">
                  <i class="bi bi-person-circle fs-4 text-success"></i>
                  <span class="ms-2 px-2 text-success">Usuário</span>
                </a>
              </li>
            </ul>
            <div class="d-flex flex-column align-items-center">
              <span class="navbar-text mb-2"
                >"Encontre seus amigos de volta"</span
              >
          </div>
        </div>
      </nav>
    </header>

    <main class="container mt-5">
      <div id="resultado"></div>

      <form id="cadastro-animal">
        <div class="mb-3">
          <label for="nome" class="form-label">Nome do Animal</label>
          <input type="text" class="form-control" id="nome" required />
        </div>
        <div class="mb-3">
          <label for="tipo" class="form-label">Tipo</label>
          <select class="form-select" id="tipo" required>
            <option value="" disabled selected>Selecione o tipo</option>
            <option value="Cachorro">Cachorro</option>
            <option value="Gato">Gato</option>
            <option value="Pássaro">Pássaro</option>
            <option value="Outro">Outro</option>
          </select>
        </div>
        <div class="mb-3">
          <label for="idade" class="form-label">Idade</label>
          <input type="number" class="form-control" id="idade" required />
        </div>
        <div class="mb-3">
          <label for="descricao" class="form-label">Descrição</label>
          <textarea class="form-control" id="descricao" required></textarea>
        </div>
        <div class="mb-3">
          <label for="regiao" class="form-label">Região do Pet</label>
          <select class="form-select" id="regiao" required>
            <option value="" disabled selected>Selecione a região</option>
            <option value="Afonso Pena">Afonso Pena</option>
            <option value="Anchieta">Anchieta</option>
            <option value="Belvedere">Belvedere</option>
            <option value="Buritis">Buritis</option>
            <option value="Funcionários">Funcionários</option>
            <option value="Lourdes">Lourdes</option>
            <option value="Mangabeiras">Mangabeiras</option>
            <option value="Nova Lima">Nova Lima</option>
            <option value="Nova Serrana">Nova Serrana</option>
            <option value="Pampulha">Pampulha</option>
            <option value="Santo Antônio">Santo Antônio</option>
            <option value="São Pedro">São Pedro</option>
            <option value="Savassi">Savassi</option>
            <option value="Serra">Serra</option>
          </select>
        </div>
        <div class="mb-3">
          <label for="imagem" class="form-label">Imagem (Upload)</label>
          <input
            type="file"
            class="form-control"
            id="imagem"
            accept="image/*"
          />
          <small class="form-text">Ou insira uma URL abaixo:</small>
          <input
            type="url"
            class="form-control"
            id="imagem-url"
            placeholder="https://exemplo.com/imagem.jpg"
          />
        </div>
        <button type="submit" class="btn btn-primary mb-4">
          Cadastrar Animal
        </button>
      </form>
    </main>

    <footer>
      <div class="container">
        <p class="mb-1">Encontre animais desaparecidos na sua região.</p>
        <small>&copy; 2024 Todos os direitos reservados | PetFinder</small>
      </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script>
      document
        .getElementById("cadastro-animal")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          const nome = document.getElementById("nome").value;
          const tipo = document.getElementById("tipo").value;
          const idade = document.getElementById("idade").value;
          const descricao = document.getElementById("descricao").value;
          const imagem = document.getElementById("imagem").files[0];
          const imagemUrl = document.getElementById("imagem-url").value;
          const regiao = document.getElementById("regiao").value; // Capturando a região

          const animalData = {
            nome: nome,
            tipo: tipo,
            idade: idade,
            descricao: descricao,
            imagem: imagem ? imagem.name : imagemUrl,
            regiao: regiao, // Incluindo a região no objeto
          };

          fetch("http://localhost:3000/animais", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(animalData),
          })
            .then((response) => response.json())
            .then((data) => {
              console.log("Resposta do servidor:", data);
              document.getElementById("resultado").innerHTML = ` 
                        <div class="alert alert-success" role="alert">
                            Animal cadastrado com sucesso!
                        </div>
                    `;
              document.getElementById("cadastro-animal").reset();
            })
            .catch((error) => {
              console.error("Erro:", error);
              document.getElementById("resultado").innerHTML = ` 
                        <div class="alert alert-danger" role="alert">
                            Ocorreu um erro ao cadastrar o animal.
                        </div>
                    `;
            });
        });
    </script>
  </body>
</html>
